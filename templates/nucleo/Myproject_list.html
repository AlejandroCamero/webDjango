{% extends 'index.html' %}
{% load static %}
{% block title %}
Mis proyectos
{% endblock title %}
{% block content %}
<header class="masthead" style="background-image: url('{% static 'assets/img/home-bg.jpg' %}">
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="site-heading">
                    <h1>Proyectos</h1>
                </div>
            </div>
        </div>
    </div>
</header>
</br>
<div class="container">
    <div class="row">
        <div class="col">
            {% if not request.user.is_staff %}
            <div class="container mb-4">
                <form action="{% url 'informe_pdf' %}" method="POST">
                    {%csrf_token%}
                    <fieldset class="form-group">
                        <legend>Generar informe entre fechas</legend>
                        <label for="fecha_ini">Fecha 1</label>
                        <input class="form-control col-3" type="date" id="fecha_ini" name="fecha_ini">
                        <label for="fecha_fin">Fecha 2</label>
                        <input class="form-control col-3" type="date" id="fecha_fin" name="fecha_fin">
                        <button type="submit" name=""class="btn btn-info mt-4">Generar Informe PDF</button>
                    </fieldset>
                </form>
                <small>NOTA: En el informe s√≥lo aparecen los proyectos finalizados, es decir aquellos marcados con color verde.</small>
            </div>
            {% endif %}
            
            <table class="table">
                <thead class="thead-dark">
                <tr>
                    <th scope="col">Titulo</th>
                    <th scope="col">Descripcion</th>
                    <th scope="col">Nivel</th>
                    <th scope="col">Fecha de inicio</th>
                    <th scope="col">Fecha de fin</th>
                    <th scope="col">Categoria</th>
                    <th scope="col">Reporte</th>
                    {% if request.user.is_staff %}
                    <th scope="col">Opciones</th>
                    {% endif %}
                </tr>
                </thead>
                <tbody>
                    {% for p in object_list %}
                    <tr>
                        {% if not request.user.is_staff %}
                            {% if p.idProject.is_finalized %}
                            <th scope="row" style="background-color:#198754; color:white">{{ p.idProject.title }}</th>
                            {% else %}
                            <th scope="row">{{ p.idProject.title }}</th>
                            {% endif %}
                        <td>{{ p.idProject.description }}</td>
                        <td>{{ p.idProject.level }}</td>
                        <td>{{ p.idProject.initDate }}</td>
                        <td>{{ p.idProject.finDate }}</td>
                        <td>{{ p.idProject.idCategory.name }}</td>
                        <td>{{ p.idProject.report }}</td>
                        {% else %}
                        <th scope="row">{{ p.title }}</th>
                        <td>{{ p.description }}</td>
                        <td>{{ p.level }}</td>
                        <td>{{ p.initDate }}</td>
                        <td>{{ p.finDate }}</td>
                        <td>{{ p.idCategory.name }}</td>
                        <td>{{ p.report }}</td>
                        <td>
                            <a class="btn btn-info btn-sm" href="{% url 'projectClients' p.id %}">Ver participantes</a>
                            <a class="btn btn-warning btn-sm" href="{% url 'projectUpdate' p.id %}">Modificar</a>
                            <a class="btn btn-danger btn-sm" href="{% url 'projectDelete' p.id %}">Eliminar</a>
                        </td>
                        {% endif %}
                    </tr>
                    {% empty %}
                    <li>No projects yet.</li>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock content %}